#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2018 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:

- matcher:
    require:
    - 'agent.product.(1)name="Profile"'
    - 'agent.product.(1)name="Configuration"'
    extract:
    - 'DeviceClass                         :    300 :"Mobile"'
    - 'DeviceName                          :    300 :agent.(1)product.(1)name'
    - 'DeviceVersion                       :    300 :agent.(1)product.(1)name^.version'
    - 'AgentClass                          :      4 :"Unknown"'
    - 'AgentName                           :      4 :"Unknown"'
    - 'AgentVersion                        :      4 :"Unknown"'

- matcher:
    extract:
    - 'DeviceClass                         :    302 :"Mobile"'
    - 'DeviceName                          :    402 :agent.(1)product.(1)name[2]="Linux"@[-1]'
    - 'DeviceFirmwareVersion               :    402 :agent.product.(1)name="Release"^.version'
    - 'AgentClass                          :      4 :"Unknown"'
    - 'AgentName                           :      4 :"Unknown"'
    - 'AgentVersion                        :      4 :"Unknown"'

- matcher:
    extract:
    - 'DeviceClass                         :    302 :"Mobile"'
    - 'DeviceName                          :    402 :agent.(1)product.(1)name[3]="Linux"@[-2]'
    - 'DeviceFirmwareVersion               :    402 :agent.product.(1)name="Release"^.version'
    - 'AgentClass                          :      4 :"Unknown"'
    - 'AgentName                           :      4 :"Unknown"'
    - 'AgentVersion                        :      4 :"Unknown"'

- matcher:
    extract:
    - 'DeviceClass                         :    302 :"Mobile"'
    - 'DeviceName                          :    402 :agent.(1)product.(1)name[4]="Linux"@[-3]'
    - 'DeviceFirmwareVersion               :    402 :agent.product.(1)name="Release"^.version'
    - 'AgentClass                          :      4 :"Unknown"'
    - 'AgentName                           :      4 :"Unknown"'
    - 'AgentVersion                        :      4 :"Unknown"'

- matcher:
    require:
    - 'agent.product.(1)name="Browser"'
    extract:
    - 'DeviceClass                         :    301 :"Mobile"'
    - 'DeviceName                          :    300 :agent.(1)product.(1)name'
    - 'DeviceVersion                       :    300 :agent.(1)product.(1)version'
    - 'AgentClass                          :      4 :"Unknown"'
    - 'AgentName                           :      4 :"Unknown"'
    - 'AgentVersion                        :      4 :"Unknown"'

- matcher:
    extract:
    - 'DeviceClass                         :    301 :"Mobile"'
    - 'DeviceName                          :    301 :agent.(1)product.(1)name'
    - 'DeviceVersion                       :    301 :agent.(1)product.(1)version'
    - 'DeviceFirmwareVersion               :    301 :agent.product.(1)name="Release"^.version'
    - 'AgentClass                          :      4 :"Unknown"'
    - 'AgentName                           :      4 :"Unknown"'
    - 'AgentVersion                        :      4 :"Unknown"'

- matcher:
    extract:
    - 'DeviceClass                         :    302 :"Mobile"'
    - 'DeviceName                          :    302 :agent.(1)product[-2]'
    - 'DeviceVersion                       :    302 :agent.(1)product.(2)version'
    - 'DeviceFirmwareVersion               :    302 :agent.product.(1)name="Release"^.version'

- matcher:
    variable:
    - 'BrowserVersion:agent.product.(1)name="Browser"^.version'
    require:
    - 'agent.product.(1)version{"AppleWebKit"'
    - '@BrowserVersion{"AppleWebKit"'
    extract:
    - 'LayoutEngineClass                   :      1 :"Browser"'
    - 'LayoutEngineName                    :      1 :"AppleWebKit"'
    - 'LayoutEngineVersion                 :      1 :@BrowserVersion'

- matcher:
    extract:
    - 'AgentClass                          :    100 :"Browser"'
    - 'AgentName                           :    100 :"Dolfin"'
    - 'AgentVersion                        :    100 :agent.product.name="Dolfin"^.version'

- matcher:
    extract:
    - 'AgentClass                          :    100 :"Testclient"'
    - 'AgentName                           :    100 :"Jasmine"'
    - 'AgentVersion                        :    100 :agent.product.name="Jasmine"^.version'


# http://www.ucweb.com/download/UCBrowser_User_Agent_en.pdf


- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    430 :agent.(1)product.(1)comments.(7)entry.(1)product.(1)name'
    - 'DeviceVersion                       :    430 :agent.(1)product.(1)comments.(7)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    429 :agent.(1)product.(1)comments.(7)entry.text'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    428 :agent.(1)product.(1)comments.(6)entry.(1)product.(1)name'
    - 'DeviceVersion                       :    428 :agent.(1)product.(1)comments.(6)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    427 :agent.(1)product.(1)comments.(6)entry.text'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    426 :agent.(1)product.(1)comments.(5)entry.(1)product.(1)name'
    - 'DeviceVersion                       :    426 :agent.(1)product.(1)comments.(5)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    425 :agent.(1)product.(1)comments.(5)entry.text'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    424 :agent.(1)product.(1)comments.(4)entry.(1)product.(1)name'
    - 'DeviceVersion                       :    424 :agent.(1)product.(1)comments.(4)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    423 :agent.(1)product.(1)comments.(4)entry.text'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    421 :agent.(1)product.(1)comments.(3)entry.(1)product.(1)name'
    - 'DeviceVersion                       :    422 :agent.(1)product.(1)comments.(3)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    421 :agent.(1)product.(1)comments.(3)entry.text'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     10 :agent.(1)product.(1)comments.(1)entry'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    420 :agent.(1)product.(1)comments.(7)entry.(1)product.(1)name'
    - 'DeviceVersion                       :    420 :agent.(1)product.(1)comments.(7)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    429 :agent.(1)product.(1)comments.(7)entry.text'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    428 :agent.(1)product.(1)comments.(6)entry.(1)product.(1)name'
    - 'DeviceVersion                       :    428 :agent.(1)product.(1)comments.(6)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    427 :agent.(1)product.(1)comments.(6)entry.text'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    426 :agent.(1)product.(1)comments.(5)entry.(1)product.(1)name'
    - 'DeviceVersion                       :    426 :agent.(1)product.(1)comments.(5)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    425 :agent.(1)product.(1)comments.(5)entry.text'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    424 :agent.(1)product.(1)comments.(4)entry.(1)product.(1)name'
    - 'DeviceVersion                       :    424 :agent.(1)product.(1)comments.(4)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    423 :agent.(1)product.(1)comments.(4)entry.text'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    422 :agent.(1)product.(1)comments.(3)entry.(1)product.(1)name'
    - 'DeviceVersion                       :    422 :agent.(1)product.(1)comments.(3)entry.(1)product.(1)version'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :     10 :"??"'

- matcher:
    require:
    - 'agent.(1)product.(1)name="UCWEB"'
    extract:
    - 'DeviceName                          :    421 :agent.(1)product.(1)comments.(3)entry.text'
    - 'OperatingSystemClass                :     10 :"Mobile"'
    - 'OperatingSystemName                 :     11 :LookUp[OSNameCleanup;agent.(1)product.(1)comments.(1)entry]'
    - 'OperatingSystemVersion              :     10 :"??"'


- matcher:
    require:
    - 'agent.product.(1)name="UCBrowser"'
    extract:
    - 'DeviceClass                         :     30 :"Tablet"'

- matcher:
    require:
    - 'agent.product.(1)name="UCBrowser"'
    - 'agent.product.name[1]="Mobile"'
    extract:
    - 'DeviceClass                         :    332 :"Phone"'

- matcher:
    require:
    - 'agent.product.(1)name="UCBrowser"'
    - 'agent.text="Mobile"'
    extract:
    - 'DeviceClass                         :    332 :"Phone"'

- matcher:
    require:
    - 'agent.product.(1)name="UCWEB"'
    extract:
    - 'DeviceClass                         :    330 :"Tablet"'

- matcher:
    require:
    - 'agent.product.(1)name="UCWEB"'
    - 'agent.text="Mobile"'
    extract:
    - 'DeviceClass                         :    332 :"Phone"'

- matcher:
    require:
    - 'agent.product.(1)name="UCWEB"'
    - 'agent.product.name[1]="Mobile"'
    extract:
    - 'DeviceClass                         :    332 :"Phone"'



- matcher:
    extract:
    - 'LayoutEngineClass                   :    131 :"Browser"'
    - 'LayoutEngineName                    :    131 :"UCBrowser"'
    - 'LayoutEngineVersion                 :    131 :agent.product.name="UCBrowser"^.version'
    - 'AgentClass                          :    131 :"Browser"'
    - 'AgentName                           :    131 :"UCBrowser"'
    - 'AgentVersion                        :    131 :agent.product.name="UCBrowser"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass                   :    132 :"Browser"'
    - 'LayoutEngineName                    :    132 :"UCBrowser U2"'
    - 'LayoutEngineVersion                 :    132 :agent.product.name="U2"^.version'
    - 'AgentClass                          :    131 :"Browser"'
    - 'AgentName                           :    131 :"UCBrowser"'
    - 'AgentVersion                        :    131 :agent.product.name="UCBrowser"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass                   :    133 :"Browser"'
    - 'LayoutEngineName                    :    133 :"UCBrowser U3"'
    - 'LayoutEngineVersion                 :    133 :agent.product.name="U3"^.version'
    - 'AgentClass                          :    131 :"Browser"'
    - 'AgentName                           :    131 :"UCBrowser"'
    - 'AgentVersion                        :    131 :agent.product.name="UCBrowser"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass                   :    122 :"Browser"'
    - 'LayoutEngineName                    :    122 :"UCBrowser U2"'
    - 'LayoutEngineVersion                 :    122 :agent.product.name="U2"^.version'
    - 'AgentClass                          :    121 :"Browser"'
    - 'AgentName                           :    121 :"UCBrowser"'
    - 'AgentVersion                        :    121 :agent.product.name="UCWEB"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass                   :    123 :"Browser"'
    - 'LayoutEngineName                    :    123 :"UCBrowser U3"'
    - 'LayoutEngineVersion                 :    123 :agent.product.name="U3"^.version'
    - 'AgentClass                          :    121 :"Browser"'
    - 'AgentName                           :    121 :"UCBrowser"'
    - 'AgentVersion                        :    121 :agent.product.name="UCWEB"^.version'


