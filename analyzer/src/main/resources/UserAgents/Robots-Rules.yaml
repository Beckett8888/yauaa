#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2018 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# These are examples of robot/spider/bot useragents we have seen.

config:

- lookup:
    name: 'NamedRobots'
    map:
      'DejaClick'                  : 'DejaClick'
      'Site-Shot'                  : 'Site-Shot'
      'Vagabondo'                  : 'Wise-Guys'
      'Netcraft Web Server Survey' : 'Netcraft'
      'Dataprovider.com'           : 'Dataprovider.com'
      'SEOkicks'                   : 'SEOkicks'
      'PingdomPageSpeed'           : 'Pingdom'
      'Facebot Twitterbot'         : 'Facebook'
      'Twitterbot'                 : 'Twitter'

- matcher:
    variable:
    - 'RobotProductName:agent.product.name?NamedRobots'
    extract:
    - 'DeviceClass                         :   1000 :"Robot"'
    - 'DeviceBrand                         :   1000 :LookUp[NamedRobots;@RobotProductName]'
    - 'DeviceName                          :   1000 :@RobotProductName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'LayoutEngineClass                   :   1000 :"Robot"'
    - 'LayoutEngineName                    :   1000 :@RobotProductName'
    - 'LayoutEngineVersion                 :   1000 :@RobotProductName^.version'
    - 'AgentClass                          :   1000 :"Robot"'
    - 'AgentName                           :   1000 :@RobotProductName'
    - 'AgentVersion                        :   1000 :@RobotProductName^.version'

- matcher:
    variable:
    - 'RobotProductName:agent.product.comments.entry.product.name?NamedRobots'
    extract:
    - 'DeviceClass                         :   1000 :"Robot"'
    - 'DeviceBrand                         :   1000 :LookUp[NamedRobots;@RobotProductName]'
    - 'DeviceName                          :   1000 :@RobotProductName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'LayoutEngineClass                   :   1000 :"Robot"'
    - 'LayoutEngineName                    :   1000 :@RobotProductName'
    - 'LayoutEngineVersion                 :   1000 :@RobotProductName^.version'
    - 'AgentClass                          :   1000 :"Robot"'
    - 'AgentName                           :   1000 :@RobotProductName'
    - 'AgentVersion                        :   1000 :@RobotProductName^.version'


- matcher:
    variable:
    - 'RobotProductName:agent.product.comments.entry.text?NamedRobots'
    extract:
    - 'DeviceClass                         :   1000 :"Robot"'
    - 'DeviceBrand                         :   1000 :LookUp[NamedRobots;@RobotProductName]'
    - 'DeviceName                          :   1000 :@RobotProductName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'LayoutEngineClass                   :   1000 :"Robot"'
    - 'LayoutEngineName                    :   1000 :@RobotProductName'
    - 'LayoutEngineVersion                 :   1000 :"??"'
    - 'AgentClass                          :   1000 :"Robot"'
    - 'AgentName                           :   1000 :@RobotProductName'
    - 'AgentVersion                        :   1000 :"??"'

# --------------------------------------------------------------------------------------
- matcher:
    variable:
    - 'RobotProduct:agent.product.version~"spider"^'
    extract:
    - 'DeviceClass                         :    102 :"Robot"'
    - 'DeviceName                          :    102 :@RobotProduct.name'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    102 :"Cloud"'
    - 'OperatingSystemName                 :    102 :"Cloud"'
    - 'OperatingSystemVersion              :    102 :"Cloud"'
    - 'LayoutEngineClass                   :    102 :"Robot"'
    - 'LayoutEngineName                    :    102 :@RobotProduct.name'
    - 'LayoutEngineVersion                 :    102 :@RobotProduct.(1)version'
    - 'AgentClass                          :    102 :"Robot"'
    - 'AgentName                           :    102 :@RobotProduct.name'
    - 'AgentVersion                        :    102 :@RobotProduct.(1)version'

- matcher:
    variable:
    - 'RobotProduct:agent.product.version~"crawl"^'
    extract:
    - 'DeviceClass                         :    102 :"Robot"'
    - 'DeviceName                          :    102 :@RobotProduct.name'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    102 :"Cloud"'
    - 'OperatingSystemName                 :    102 :"Cloud"'
    - 'OperatingSystemVersion              :    102 :"Cloud"'
    - 'LayoutEngineClass                   :    102 :"Robot"'
    - 'LayoutEngineName                    :    102 :@RobotProduct.name'
    - 'LayoutEngineVersion                 :    102 :@RobotProduct.(1)version'
    - 'AgentClass                          :    102 :"Robot"'
    - 'AgentName                           :    102 :@RobotProduct.name'
    - 'AgentVersion                        :    102 :@RobotProduct.(1)version'


- matcher:
    variable:
    - 'RobotProduct:agent.product.version~"bot"^'
    extract:
    - 'DeviceClass                         :    102 :"Robot"'
    - 'DeviceName                          :    102 :@RobotProduct.name'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    102 :"Cloud"'
    - 'OperatingSystemName                 :    102 :"Cloud"'
    - 'OperatingSystemVersion              :    102 :"Cloud"'
    - 'LayoutEngineClass                   :    102 :"Robot"'
    - 'LayoutEngineName                    :    102 :@RobotProduct.name'
    - 'LayoutEngineVersion                 :    102 :@RobotProduct.(1)version'
    - 'AgentClass                          :    102 :"Robot"'
    - 'AgentName                           :    102 :@RobotProduct.name'
    - 'AgentVersion                        :    102 :@RobotProduct.(1)version'


- matcher:
    variable:
    - 'RobotProduct:agent.product.version~"scan"^'
    extract:
    - 'DeviceClass                         :    102 :"Robot"'
    - 'DeviceName                          :    102 :@RobotProduct.name'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    102 :"Cloud"'
    - 'OperatingSystemName                 :    102 :"Cloud"'
    - 'OperatingSystemVersion              :    102 :"Cloud"'
    - 'LayoutEngineClass                   :    102 :"Robot"'
    - 'LayoutEngineName                    :    102 :@RobotProduct.name'
    - 'LayoutEngineVersion                 :    102 :@RobotProduct.(1)version'
    - 'AgentClass                          :    102 :"Robot"'
    - 'AgentName                           :    102 :@RobotProduct.name'
    - 'AgentVersion                        :    102 :@RobotProduct.(1)version'

#- matcher:
#    variable:
#    - 'RobotProduct:agent.product.version~"checker"^'
#    extract:
#    - 'DeviceClass           :  102:"Robot"'
#    - 'DeviceName            :  102:@RobotProduct.name'
#    - 'DeviceCpu             : 1000:"<<<null>>>"'
#    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
#    - 'OperatingSystemClass  :  102:"Cloud"'
#    - 'OperatingSystemName   :  102:"Cloud"'
#    - 'OperatingSystemVersion:  102:"Cloud"'
#    - 'LayoutEngineClass     :  102:"Robot"'
#    - 'LayoutEngineName      :  102:@RobotProduct.name'
#    - 'LayoutEngineVersion   :  102:@RobotProduct.(1)version'
#    - 'AgentClass            :  102:"Robot"'
#    - 'AgentName             :  102:@RobotProduct.name'
#    - 'AgentVersion          :  102:@RobotProduct.(1)version'

# --------------------------------------------------------------------------------------


- matcher:
    variable:
    - 'RobotName:agent.text~"spider"'
    extract:
    - 'DeviceClass                         :    101 :"Robot"'
    - 'DeviceName                          :    101 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    101 :"Cloud"'
    - 'OperatingSystemName                 :    101 :"Cloud"'
    - 'OperatingSystemVersion              :    101 :"Cloud"'
    - 'LayoutEngineClass                   :    101 :"Robot"'
    - 'LayoutEngineName                    :    101 :@RobotName'
    - 'LayoutEngineVersion                 :    101 :"??"'
    - 'AgentClass                          :    101 :"Robot"'
    - 'AgentName                           :    101 :@RobotName'
    - 'AgentVersion                        :    101 :"??"'


- matcher:
    variable:
    - 'RobotName:agent.text~"crawl"'
    extract:
    - 'DeviceClass                         :    101 :"Robot"'
    - 'DeviceName                          :    101 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    101 :"Cloud"'
    - 'OperatingSystemName                 :    101 :"Cloud"'
    - 'OperatingSystemVersion              :    101 :"Cloud"'
    - 'LayoutEngineClass                   :    101 :"Robot"'
    - 'LayoutEngineName                    :    101 :@RobotName'
    - 'LayoutEngineVersion                 :    101 :"??"'
    - 'AgentClass                          :    101 :"Robot"'
    - 'AgentName                           :    101 :@RobotName'
    - 'AgentVersion                        :    101 :"??"'


- matcher:
    variable:
    - 'RobotName:agent.text~"bot"'
    extract:
    - 'DeviceClass                         :    101 :"Robot"'
    - 'DeviceName                          :    101 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    101 :"Cloud"'
    - 'OperatingSystemName                 :    101 :"Cloud"'
    - 'OperatingSystemVersion              :    101 :"Cloud"'
    - 'LayoutEngineClass                   :    101 :"Robot"'
    - 'LayoutEngineName                    :    101 :@RobotName'
    - 'LayoutEngineVersion                 :    101 :"??"'
    - 'AgentClass                          :    101 :"Robot"'
    - 'AgentName                           :    101 :@RobotName'
    - 'AgentVersion                        :    101 :"??"'


- matcher:
    variable:
    - 'RobotName:agent.text~"scan"'
    extract:
    - 'DeviceClass                         :    101 :"Robot"'
    - 'DeviceName                          :    101 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    101 :"Cloud"'
    - 'OperatingSystemName                 :    101 :"Cloud"'
    - 'OperatingSystemVersion              :    101 :"Cloud"'
    - 'LayoutEngineClass                   :    101 :"Robot"'
    - 'LayoutEngineName                    :    101 :@RobotName'
    - 'LayoutEngineVersion                 :    101 :"??"'
    - 'AgentClass                          :    101 :"Robot"'
    - 'AgentName                           :    101 :@RobotName'
    - 'AgentVersion                        :    101 :"??"'

- matcher:
    variable:
    - 'RobotName:agent.text~"checker"'
    extract:
    - 'DeviceClass                         :    101 :"Robot"'
    - 'DeviceName                          :    101 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    101 :"Cloud"'
    - 'OperatingSystemName                 :    101 :"Cloud"'
    - 'OperatingSystemVersion              :    101 :"Cloud"'
    - 'LayoutEngineClass                   :    101 :"Robot"'
    - 'LayoutEngineName                    :    101 :@RobotName'
    - 'LayoutEngineVersion                 :    101 :"??"'
    - 'AgentClass                          :    101 :"Robot"'
    - 'AgentName                           :    101 :@RobotName'
    - 'AgentVersion                        :    101 :"??"'

# --------------------------------------------------------------------------------------

- matcher:
    variable:
    - 'RobotName:agent.product.name~"spider"'
    extract:
    - 'DeviceClass                         :    111 :"Robot"'
    - 'DeviceName                          :    111 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    111 :"Cloud"'
    - 'OperatingSystemName                 :    111 :"Cloud"'
    - 'OperatingSystemVersion              :    111 :"Cloud"'
    - 'LayoutEngineClass                   :    111 :"Robot"'
    - 'LayoutEngineName                    :    111 :@RobotName'
    - 'LayoutEngineVersion                 :    111 :"??"'
    - 'AgentClass                          :    111 :"Robot"'
    - 'AgentName                           :    111 :@RobotName'
    - 'AgentVersion                        :    111 :"??"'

- matcher:
    require:
    - 'agent.product.name~"spider"@~"mobile"'
    extract:
    - 'DeviceClass                         :    112 :"Robot Mobile"'

- matcher:
    variable:
    - 'RobotVersion:agent.product.name~"spider"^.(1)version'
    extract:
    - 'LayoutEngineVersion                 :    112 :@RobotVersion'
    - 'AgentVersion                        :    112 :@RobotVersion'

- matcher:
    variable:
    - 'RobotName:agent.product.name~"crawl"'
    extract:
    - 'DeviceClass                         :    111 :"Robot"'
    - 'DeviceName                          :    111 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    111 :"Cloud"'
    - 'OperatingSystemName                 :    111 :"Cloud"'
    - 'OperatingSystemVersion              :    111 :"Cloud"'
    - 'LayoutEngineClass                   :    111 :"Robot"'
    - 'LayoutEngineName                    :    111 :@RobotName'
    - 'LayoutEngineVersion                 :    111 :"??"'
    - 'AgentClass                          :    111 :"Robot"'
    - 'AgentName                           :    111 :@RobotName'
    - 'AgentVersion                        :    111 :"??"'

- matcher:
    require:
    - 'agent.product.name~"crawl"@~"mobile"'
    extract:
    - 'DeviceClass                         :    112 :"Robot Mobile"'

- matcher:
    variable:
    - 'RobotVersion:agent.product.name~"crawl"^.(1)version'
    extract:
    - 'LayoutEngineVersion                 :    112 :@RobotVersion'
    - 'AgentVersion                        :    112 :@RobotVersion'

- matcher:
    variable:
    - 'RobotName:agent.product.name~"bot"'
    extract:
    - 'DeviceClass                         :    111 :"Robot"'
    - 'DeviceName                          :    111 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    111 :"Cloud"'
    - 'OperatingSystemName                 :    111 :"Cloud"'
    - 'OperatingSystemVersion              :    111 :"Cloud"'
    - 'LayoutEngineClass                   :    111 :"Robot"'
    - 'LayoutEngineName                    :    111 :@RobotName'
    - 'LayoutEngineVersion                 :    111 :"??"'
    - 'AgentClass                          :    111 :"Robot"'
    - 'AgentName                           :    111 :@RobotName'
    - 'AgentVersion                        :    111 :"??"'

- matcher:
    require:
    - 'agent.product.name~"bot"@~"mobile"'
    extract:
    - 'DeviceClass                         :    112 :"Robot Mobile"'

- matcher:
    variable:
    - 'RobotVersion:agent.product.name~"bot"^.(1)version'
    extract:
    - 'LayoutEngineVersion                 :    112 :@RobotVersion'
    - 'AgentVersion                        :    112 :@RobotVersion'

- matcher:
    variable:
    - 'RobotName:agent.product.name~"scan"'
    extract:
    - 'DeviceClass                         :    111 :"Robot"'
    - 'DeviceName                          :    111 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    111 :"Cloud"'
    - 'OperatingSystemName                 :    111 :"Cloud"'
    - 'OperatingSystemVersion              :    111 :"Cloud"'
    - 'LayoutEngineClass                   :    111 :"Robot"'
    - 'LayoutEngineName                    :    111 :@RobotName'
    - 'LayoutEngineVersion                 :    111 :"??"'
    - 'AgentClass                          :    111 :"Robot"'
    - 'AgentName                           :    111 :@RobotName'
    - 'AgentVersion                        :    111 :"??"'

- matcher:
    require:
    - 'agent.product.name~"scan"@~"mobile"'
    extract:
    - 'DeviceClass                         :    112 :"Robot Mobile"'

- matcher:
    variable:
    - 'RobotVersion:agent.product.name~"scan"^.(1)version'
    extract:
    - 'LayoutEngineVersion                 :    112 :@RobotVersion'
    - 'AgentVersion                        :    112 :@RobotVersion'

#- matcher:
#    variable:
#    - 'RobotName:agent.product.name~"checker"'
#    extract:
#    - 'DeviceClass           :  111:"Robot"'
#    - 'DeviceName            :  111:@RobotName'
#    - 'DeviceCpu             : 1000:"<<<null>>>"'
#    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
#    - 'OperatingSystemClass  :  111:"Cloud"'
#    - 'OperatingSystemName   :  111:"Cloud"'
#    - 'OperatingSystemVersion:  111:"Cloud"'
#    - 'LayoutEngineClass     :  111:"Robot"'
#    - 'LayoutEngineName      :  111:@RobotName'
#    - 'LayoutEngineVersion   :  111:"??"'
#    - 'AgentClass            :  111:"Robot"'
#    - 'AgentName             :  111:@RobotName'
#    - 'AgentVersion          :  111:"??"'
#
#- matcher:
#    require:
#    - 'agent.product.name~"checker"@~"mobile"'
#    extract:
#    - 'DeviceClass           :  112:"Robot Mobile"'
#
#- matcher:
#    variable:
#    - 'RobotVersion:agent.product.name~"checker"^.(1)version'
#    extract:
#    - 'LayoutEngineVersion   :  112:@RobotVersion'
#    - 'AgentVersion          :  112:@RobotVersion'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.product.name~"spider"'
    extract:
    - '__Set_ALL_Fields__                  :     99 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :    100 :"Robot"'
    - 'DeviceName                          :    100 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    100 :"Cloud"'
    - 'OperatingSystemName                 :    100 :"Cloud"'
    - 'OperatingSystemVersion              :    100 :"Cloud"'
    - 'LayoutEngineClass                   :    100 :"Robot"'
    - 'LayoutEngineName                    :    100 :@RobotName'
    - 'LayoutEngineVersion                 :    100 :@RobotName^.version'
    - 'AgentClass                          :    100 :"Robot"'
    - 'AgentName                           :    100 :@RobotName'
    - 'AgentVersion                        :    100 :@RobotName^.version'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.product.name~"crawl"'
    extract:
    - '__Set_ALL_Fields__                  :     99 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :    100 :"Robot"'
    - 'DeviceName                          :    100 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    100 :"Cloud"'
    - 'OperatingSystemName                 :    100 :"Cloud"'
    - 'OperatingSystemVersion              :    100 :"Cloud"'
    - 'LayoutEngineClass                   :    100 :"Robot"'
    - 'LayoutEngineName                    :    100 :@RobotName'
    - 'LayoutEngineVersion                 :    100 :@RobotName^.version'
    - 'AgentClass                          :    100 :"Robot"'
    - 'AgentName                           :    100 :@RobotName'
    - 'AgentVersion                        :    100 :@RobotName^.version'

- matcher:
    require:
    - 'IsNull[agent.(1)product.comments.entry.product.name[1]="cubot"]'
    variable:
    - 'RobotName:agent.(1)product.comments.entry.product.name~"bot"'
    extract:
    - '__Set_ALL_Fields__                  :     99 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :    100 :"Robot"'
    - 'DeviceName                          :    100 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    100 :"Cloud"'
    - 'OperatingSystemName                 :    100 :"Cloud"'
    - 'OperatingSystemVersion              :    100 :"Cloud"'
    - 'LayoutEngineClass                   :    100 :"Robot"'
    - 'LayoutEngineName                    :    100 :@RobotName'
    - 'LayoutEngineVersion                 :    100 :@RobotName^.version'
    - 'AgentClass                          :    100 :"Robot"'
    - 'AgentName                           :    100 :@RobotName'
    - 'AgentVersion                        :    100 :@RobotName^.version'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.product.name~"scan"'
    extract:
    - '__Set_ALL_Fields__                  :     99 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :    100 :"Robot"'
    - 'DeviceName                          :    100 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    100 :"Cloud"'
    - 'OperatingSystemName                 :    100 :"Cloud"'
    - 'OperatingSystemVersion              :    100 :"Cloud"'
    - 'LayoutEngineClass                   :    100 :"Robot"'
    - 'LayoutEngineName                    :    100 :@RobotName'
    - 'LayoutEngineVersion                 :    100 :@RobotName^.version'
    - 'AgentClass                          :    100 :"Robot"'
    - 'AgentName                           :    100 :@RobotName'
    - 'AgentVersion                        :    100 :@RobotName^.version'

#- matcher:
#    variable:
#    - 'RobotName:agent.(1)product.comments.entry.product.name~"checker"'
#    extract:
#    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
#    - 'DeviceClass           :  100:"Robot"'
#    - 'DeviceName            :  100:@RobotName'
#    - 'DeviceCpu             : 1000:"<<<null>>>"'
#    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
#    - 'OperatingSystemClass  :  100:"Cloud"'
#    - 'OperatingSystemName   :  100:"Cloud"'
#    - 'OperatingSystemVersion:  100:"Cloud"'
#    - 'LayoutEngineClass     :  100:"Robot"'
#    - 'LayoutEngineName      :  100:@RobotName'
#    - 'LayoutEngineVersion   :  100:@RobotName^.version'
#    - 'AgentClass            :  100:"Robot"'
#    - 'AgentName             :  100:@RobotName'
#    - 'AgentVersion          :  100:@RobotName^.version'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.text~"spider"'
    extract:
    - '__Set_ALL_Fields__                  :     99 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :    100 :"Robot"'
    - 'DeviceName                          :    100 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    100 :"Cloud"'
    - 'OperatingSystemName                 :    100 :"Cloud"'
    - 'OperatingSystemVersion              :    100 :"Cloud"'
    - 'LayoutEngineClass                   :    100 :"Robot"'
    - 'LayoutEngineName                    :    100 :@RobotName'
    - 'LayoutEngineVersion                 :    100 :@RobotName'
    - 'AgentClass                          :    100 :"Robot"'
    - 'AgentName                           :    100 :@RobotName'
    - 'AgentVersion                        :    100 :@RobotName'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.text~"crawl"'
    extract:
    - '__Set_ALL_Fields__                  :     99 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :    100 :"Robot"'
    - 'DeviceName                          :    100 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    100 :"Cloud"'
    - 'OperatingSystemName                 :    100 :"Cloud"'
    - 'OperatingSystemVersion              :    100 :"Cloud"'
    - 'LayoutEngineClass                   :    100 :"Robot"'
    - 'LayoutEngineName                    :    100 :@RobotName'
    - 'LayoutEngineVersion                 :    100 :@RobotName'
    - 'AgentClass                          :    100 :"Robot"'
    - 'AgentName                           :    100 :@RobotName'
    - 'AgentVersion                        :    100 :@RobotName'

- matcher:
    require:
    - 'IsNull[agent.(1)product.comments.entry.text[1]="cubot"]'
    variable:
    - 'RobotName:agent.(1)product.comments.entry.text~"bot"'
    extract:
    - '__Set_ALL_Fields__                  :     99 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :    100 :"Robot"'
    - 'DeviceName                          :    100 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    100 :"Cloud"'
    - 'OperatingSystemName                 :    100 :"Cloud"'
    - 'OperatingSystemVersion              :    100 :"Cloud"'
    - 'LayoutEngineClass                   :    100 :"Robot"'
    - 'LayoutEngineName                    :    100 :@RobotName'
    - 'LayoutEngineVersion                 :    100 :@RobotName'
    - 'AgentClass                          :    100 :"Robot"'
    - 'AgentName                           :    100 :@RobotName'
    - 'AgentVersion                        :    100 :@RobotName'

- matcher:
    variable:
    - 'RobotName:agent.(1)product.comments.entry.text~"scan"'
    extract:
    - '__Set_ALL_Fields__                  :     99 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :    100 :"Robot"'
    - 'DeviceName                          :    100 :@RobotName'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    100 :"Cloud"'
    - 'OperatingSystemName                 :    100 :"Cloud"'
    - 'OperatingSystemVersion              :    100 :"Cloud"'
    - 'LayoutEngineClass                   :    100 :"Robot"'
    - 'LayoutEngineName                    :    100 :@RobotName'
    - 'LayoutEngineVersion                 :    100 :@RobotName'
    - 'AgentClass                          :    100 :"Robot"'
    - 'AgentName                           :    100 :@RobotName'
    - 'AgentVersion                        :    100 :@RobotName'

#- matcher:
#    variable:
#    - 'RobotName:agent.(1)product.comments.entry.text~"checker"'
#    extract:
#    - '__Set_ALL_Fields__    :   99:"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
#    - 'DeviceClass           :  100:"Robot"'
#    - 'DeviceName            :  100:@RobotName'
#    - 'DeviceCpu             : 1000:"<<<null>>>"'
#    - 'DeviceCpuBits         : 1000:"<<<null>>>"'
#    - 'OperatingSystemClass  :  100:"Cloud"'
#    - 'OperatingSystemName   :  100:"Cloud"'
#    - 'OperatingSystemVersion:  100:"Cloud"'
#    - 'LayoutEngineClass     :  100:"Robot"'
#    - 'LayoutEngineName      :  100:@RobotName'
#    - 'LayoutEngineVersion   :  100:@RobotName'
#    - 'AgentClass            :  100:"Robot"'
#    - 'AgentName             :  100:@RobotName'
#    - 'AgentVersion          :  100:@RobotName'

- matcher:
    variable:
    - 'PhantomJSVersion:agent.product.name="PhantomJS"^.version'
    extract:
    - 'DeviceClass                         :   1000 :"Robot"'
    - 'DeviceBrand                         :   1000 :"PhantomJS"'
    - 'DeviceName                          :   1000 :"PhantomJS"'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'LayoutEngineClass                   :   1000 :"Robot"'
    - 'LayoutEngineName                    :   1000 :"PhantomJS"'
    - 'LayoutEngineVersion                 :   1000 :@PhantomJSVersion'
    - 'AgentClass                          :   1000 :"Robot"'
    - 'AgentName                           :   1000 :"PhantomJS"'
    - 'AgentVersion                        :   1000 :@PhantomJSVersion'

# ------------------------------------------------------------

#Yahoo
- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.text="Yahoo! Slurp"'
    extract:
    - 'DeviceClass                         :   3020 :"Robot"'
    - 'DeviceBrand                         :   3020 :"Yahoo"'
    - 'DeviceName                          :   3020 :"Yahoo"'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :   3020 :"Cloud"'
    - 'OperatingSystemName                 :   3020 :"Yahoo"'
    - 'OperatingSystemVersion              :   3020 :"Yahoo"'
    - 'LayoutEngineClass                   :   3020 :"Robot"'
    - 'LayoutEngineName                    :   3020 :"Yahoo! Slurp"'
    - 'LayoutEngineVersion                 :   3020 :"Yahoo! Slurp"'
    - 'AgentClass                          :   3020 :"Robot"'
    - 'AgentName                           :   3020 :"Yahoo! Slurp"'
    - 'AgentVersion                        :   3020 :"Yahoo! Slurp"'

- matcher:
    extract:
    - 'DeviceClass                         :   5000 :"Robot"'
    - 'DeviceName                          :   5000 :"FlipboardProxy"'
    - 'DeviceBrand                         :   5000 :"Flipboard"'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :   5000 :"Cloud"'
    - 'OperatingSystemName                 :   5000 :"Cloud"'
    - 'OperatingSystemVersion              :   5000 :"Cloud"'
    - 'AgentClass                          :   5000 :"Robot"'
    - 'AgentName                           :   5000 :"FlipboardProxy"'
    - 'AgentVersion                        :   5000 :agent.product.(1)comments.entry.(1)product.(1)name="FlipboardProxy"^.version'

- matcher:
    extract:
    - 'DeviceClass                         :   5000 :"Robot"'
    - 'DeviceName                          :   5000 :"Applebot"'
    - 'DeviceBrand                         :   5000 :"Apple"'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :   5000 :"Cloud"'
    - 'OperatingSystemName                 :   5000 :"Cloud"'
    - 'OperatingSystemVersion              :   5000 :"Cloud"'
    - 'AgentClass                          :   5000 :"Robot"'
    - 'AgentName                           :   5000 :"Applebot"'
    - 'AgentVersion                        :   5000 :agent.product.(1)comments.entry.(1)product.(1)name="Applebot"^.version'

- matcher:
    extract:
    - 'DeviceClass                         :   2100 :"Robot"'
    - 'DeviceName                          :   2100 :agent.product.comments.entry.text="Exabot-Thumbnails"'
    - 'DeviceBrand                         :   2100 :"Exalead"'
    - 'AgentClass                          :   2100 :"Robot"'
    - 'AgentName                           :   2100 :agent.product.comments.entry.text="Exabot-Thumbnails"'
    - 'AgentVersion                        :   2100 :"??"'

# When you share a link on facebook then the Facebook systems will try to create a preview of the page
# using one of these useragents
- matcher:
    require:
    - 'agent.(1)product.(1)name="facebookexternalhit"'
    extract:
    - 'DeviceClass                         :     10 : "Robot"'
    - 'DeviceName                          :     10 : "Facebook Robot"'
    - 'DeviceBrand                         :     10 : "Facebook"'
    - 'OperatingSystemClass                :     10 : "Cloud"'
    - 'OperatingSystemName                 :     10 : "Cloud"'
    - 'OperatingSystemVersion              :     10 : "Cloud"'
    - 'OperatingSystemNameVersion          :     10 : "Cloud"'


# http://www.webpagetest.org --> PTST
# http://support.speedcurve.com/testing-process/how-do-the-browser-testing-agents-work
# SpeedCurve testing agents use the standard WebPagetest user agent and you can filter testing agents out of your analytics by search for the string "PTST/SpeedCurve" in the user agent string.

- matcher:
    variable:
    - 'PTSTVersion:agent.product.comments.entry.product.name="PTST"^.version'
    extract:
    - '__Set_ALL_Fields__                  :   4999 : "<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   5000 : "Robot"'
    - 'DeviceName                          :   5000 : "WebpageTest"'
    - 'DeviceBrand                         :   5000 : "WebpageTest"'
    - 'OperatingSystemClass                :   5000 : "Cloud"'
    - 'OperatingSystemName                 :   5000 : "Cloud"'
    - 'OperatingSystemVersion              :   5000 : "Cloud"'
    - 'LayoutEngineClass                   :   5000 : "Robot"'
    - 'LayoutEngineName                    :   5000 : "WebpageTest"'
    - 'LayoutEngineVersion                 :   5000 : @PTSTVersion'
    - 'AgentClass                          :   5000 : "Robot"'
    - 'AgentName                           :   5000 : "WebpageTest"'
    - 'AgentVersion                        :   5000 : @PTSTVersion'

- matcher:
    variable:
    - 'PTSTVersion:agent.product.name="PTST"^.version'
    extract:
    - '__Set_ALL_Fields__                  :   4999 : "<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   5000 : "Robot"'
    - 'DeviceName                          :   5000 : "WebpageTest"'
    - 'DeviceBrand                         :   5000 : "WebpageTest"'
    - 'OperatingSystemClass                :   5000 : "Cloud"'
    - 'OperatingSystemName                 :   5000 : "Cloud"'
    - 'OperatingSystemVersion              :   5000 : "Cloud"'
    - 'LayoutEngineClass                   :   5000 : "Robot"'
    - 'LayoutEngineName                    :   5000 : "WebpageTest"'
    - 'LayoutEngineVersion                 :   5000 : @PTSTVersion'
    - 'AgentClass                          :   5000 : "Robot"'
    - 'AgentName                           :   5000 : "WebpageTest"'
    - 'AgentVersion                        :   5000 : @PTSTVersion'


- matcher:
    require:
    - 'agent.product.(1)version="SpeedCurve"'
    - 'agent.product.name="PTST"^.(1)version="SpeedCurve"'
    variable:
    - 'PTSTVersion:agent.product.name="PTST"^.(2)version'
    extract:
    - '__Set_ALL_Fields__                  :   4999 : "<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   5001 : "Robot"'
    - 'DeviceName                          :   5001 : "SpeedCurve WebpageTest"'
    - 'DeviceBrand                         :   5001 : "SpeedCurve"'
    - 'OperatingSystemClass                :   5001 : "Cloud"'
    - 'OperatingSystemName                 :   5001 : "Cloud"'
    - 'OperatingSystemVersion              :   5001 : "Cloud"'
    - 'LayoutEngineClass                   :   5001 : "Robot"'
    - 'LayoutEngineName                    :   5001 : "SpeedCurve WebpageTest"'
    - 'LayoutEngineVersion                 :   5001 : @PTSTVersion'
    - 'AgentClass                          :   5001 : "Robot"'
    - 'AgentName                           :   5001 : "SpeedCurve WebpageTest"'
    - 'AgentVersion                        :   5001 : @PTSTVersion'

- matcher:
    variable:
    - 'RobotName:agent.product.comments.entry.product.name="YandexMobileBot"'
    - 'RobotVersion:@RobotName^.version'
    extract:
    - 'DeviceClass                         :    111 :"Robot Mobile"'
    - 'DeviceName                          :    111 :@RobotName'
    - 'DeviceBrand                         :   1000 :"Yandex"'
    - 'DeviceVersion                       :   1000 :"<<<null>>>"'
    - 'DeviceCpu                           :   1000 :"<<<null>>>"'
    - 'DeviceCpuBits                       :   1000 :"<<<null>>>"'
    - 'DeviceFirmwareVersion               :   1000 :"<<<null>>>"'
    - 'OperatingSystemClass                :    111 :"Cloud"'
    - 'OperatingSystemName                 :    111 :"Cloud"'
    - 'OperatingSystemVersion              :    111 :"Cloud"'
    - 'LayoutEngineClass                   :    111 :"Robot"'
    - 'LayoutEngineName                    :    111 :@RobotName'
    - 'LayoutEngineVersion                 :    111 :@RobotVersion'
    - 'AgentClass                          :    111 :"Robot"'
    - 'AgentName                           :    111 :@RobotName'
    - 'AgentVersion                        :    111 :@RobotVersion'

