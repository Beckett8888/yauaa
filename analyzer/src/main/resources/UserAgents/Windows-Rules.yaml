#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2018 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:

# Sometimes it only says "Windows" with N/U/I...
- matcher:
    require:
    - 'agent.(1)product.comments.entry="Windows"'
    - 'agent.(1)product.comments.entry="N"'
    extract:
    - 'DeviceClass                         :      1 :"Desktop"'
    - 'DeviceName                          :      1 :"Desktop"'
    - 'OperatingSystemClass                :      1 :"Desktop"'
    - 'OperatingSystemName                 :      1 :"Windows"'
    - 'OperatingSystemVersion              :      1 :"??"'
    - 'OperatingSystemNameVersion          :      1 :"Windows ??"'

- matcher:
    require:
    - 'agent.(1)product.comments.entry="Windows"'
    - 'agent.(1)product.comments.entry="U"'
    extract:
    - 'DeviceClass                         :      1 :"Desktop"'
    - 'DeviceName                          :      1 :"Desktop"'
    - 'OperatingSystemClass                :      1 :"Desktop"'
    - 'OperatingSystemName                 :      1 :"Windows"'
    - 'OperatingSystemVersion              :      1 :"??"'
    - 'OperatingSystemNameVersion          :      1 :"Windows ??"'


- matcher:
    require:
    - 'agent.(1)product.comments.entry="Windows"'
    - 'agent.(1)product.comments.entry="I"'
    extract:
    - 'DeviceClass                         :      1 :"Desktop"'
    - 'DeviceName                          :      1 :"Desktop"'
    - 'OperatingSystemClass                :      1 :"Desktop"'
    - 'OperatingSystemName                 :      1 :"Windows"'
    - 'OperatingSystemVersion              :      1 :"??"'
    - 'OperatingSystemNameVersion          :      1 :"Windows ??"'

- matcher:
    extract:
    - 'DeviceClass                         :    100 :"Desktop"'
    - 'DeviceName                          :    100 :"Desktop"'
    - 'DeviceCpuBits                       :      1 :"32"'
    - 'OperatingSystemClass                :    100 :"Desktop"'
    - 'OperatingSystemName                 :    100 :LookUp[WindowsDesktopOSName;agent.(1)product.comments.entry.product]'
    - 'OperatingSystemVersion              :    100 :LookUp[WindowsDesktopOSVersion;agent.(1)product.comments.entry.product]'
    - 'OperatingSystemNameVersion          :    100 :LookUp[WindowsDesktopOSNameVersion;agent.(1)product.comments.entry.product]'

- matcher:
    extract:
    - 'DeviceCpuBits                       :    100 :LookUp[WindowsDesktopOSCpuBits;agent.(1)product.comments.entry.product]'

- matcher:
    extract:
    - 'DeviceClass                         :     50 :"Desktop"'
    - 'DeviceName                          :     50 :"Desktop"'
    - 'DeviceCpuBits                       :      1 :"32"'
    - 'OperatingSystemClass                :     50 :"Desktop"'
    - 'OperatingSystemName                 :      5 :"Windows NT"'
    - 'OperatingSystemVersion              :      5 :agent.(1)product.(1)comments.entry.product.name="Windows NT"^.version'
    - 'OperatingSystemNameVersion          :      5 :agent.(1)product.(1)comments.entry.product.name="Windows NT"^'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.product.name[1-2]="Tablet PC"'
    extract:
    - 'DeviceClass                         :    101 :"Tablet"'
    - 'DeviceName                          :    101 :"Tablet PC"'
    - 'DeviceCpuBits                       :      1 :"32"'
    - 'OperatingSystemClass                :     50 :"Desktop"'
    - 'OperatingSystemName                 :      5 :"Windows NT"'
    - 'OperatingSystemVersion              :      5 :agent.(1)product.(1)comments.entry.product.name="Windows NT"^.version'
    - 'OperatingSystemNameVersion          :      5 :agent.(1)product.(1)comments.entry.product.name="Windows NT"^'

- matcher:
    extract:
    - 'DeviceClass                         :    100 :"Desktop"'
    - 'DeviceName                          :    100 :"Desktop"'
    - 'DeviceCpuBits                       :      1 :"32"'
    - 'OperatingSystemClass                :    100 :"Desktop"'
    - 'OperatingSystemName                 :    100 :LookUp[WindowsDesktopOSName;agent.(1)product.comments.entry.text]'
    - 'OperatingSystemVersion              :    100 :LookUp[WindowsDesktopOSVersion;agent.(1)product.comments.entry.text]'
    - 'OperatingSystemNameVersion          :    100 :LookUp[WindowsDesktopOSNameVersion;agent.(1)product.comments.entry.text]'

- matcher:
    extract:
    - 'DeviceCpuBits                       :    100 :LookUp[WindowsDesktopOSCpuBits;agent.(1)product.comments.entry.text]'

- matcher:
    extract:
    - 'DeviceClass                         :    100 :"Desktop"'
    - 'DeviceName                          :    100 :"Desktop"'
    - 'DeviceCpuBits                       :      1 :"32"'
    - 'OperatingSystemClass                :    100 :"Desktop"'
    - 'OperatingSystemName                 :    100 :LookUp[WindowsDesktopOSName;agent.product]'
    - 'OperatingSystemVersion              :    100 :LookUp[WindowsDesktopOSVersion;agent.product]'
    - 'OperatingSystemNameVersion          :    100 :LookUp[WindowsDesktopOSNameVersion;agent.product]'

- matcher:
    extract:
    - 'DeviceCpuBits                       :    100 :LookUp[WindowsDesktopOSCpuBits;agent.product]'

- matcher:
    extract:
    - 'DeviceClass                         :     50 :"Desktop"'
    - 'DeviceName                          :     50 :"Desktop"'
    - 'DeviceCpuBits                       :      1 :"32"'
    - 'OperatingSystemClass                :     50 :"Desktop"'
    - 'OperatingSystemName                 :      5 :"Windows NT"'
    - 'OperatingSystemVersion              :      5 :agent.product.name="Windows NT"^.version'
    - 'OperatingSystemNameVersion          :      5 :agent.product.name="Windows NT"^'

- matcher:
    require:
    - 'agent.product.comments.entry.text="mingw32"'
    extract:
    - 'DeviceClass                         :      1 :"Desktop"'
    - 'DeviceName                          :      1 :"Desktop"'
    - 'DeviceCpuBits                       :      1 :"32"'
    - 'OperatingSystemClass                :      1 :"Desktop"'
    - 'OperatingSystemName                 :      1 :"Windows NT"'
    - 'OperatingSystemVersion              :      1 :"??"'
    - 'OperatingSystemNameVersion          :      1 :"Windows NT ??"'

- matcher:
    require:
    - 'agent.product.comments.entry.product.(1-4)version="mingw32"'
    extract:
    - 'DeviceClass                         :      1 :"Desktop"'
    - 'DeviceName                          :      1 :"Desktop"'
    - 'DeviceCpuBits                       :      1 :"32"'
    - 'OperatingSystemClass                :      1 :"Desktop"'
    - 'OperatingSystemName                 :      1 :"Windows NT"'
    - 'OperatingSystemVersion              :      1 :"??"'
    - 'OperatingSystemNameVersion          :      1 :"Windows NT ??"'



