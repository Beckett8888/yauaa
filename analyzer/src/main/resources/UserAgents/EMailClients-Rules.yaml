#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2018 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:

- lookup:
    name: 'MSOfficeApplicationNames'
    map:
      "MAPI"   : "Microsoft Office MAPI Client" # Messaging Application Programming Interface (MAPI)
      "UCMAPI" : "Microsoft Office MAPI Client" # Messaging Application Programming Interface (MAPI)
      "InfoPath Editor" : "Microsoft Office InfoPath Editor"

- matcher:
    extract:
    - 'DeviceClass                         :      1 : "Desktop"'
    - 'AgentClass                          :      9 : "Special"'
    - 'AgentName                           :      9 : "Microsoft Office"'
    - 'AgentVersion                        :      9 : agent.(1)product.(1)name="Microsoft Office"^.version'

- matcher:
    require:
    - 'agent.(1)product.(1)name="Microsoft Office"'
    variable:
    - 'OfficeAppName: agent.(1)product.(1)comments.entry.product.name{"Microsoft "'
    extract:
    - 'DeviceClass                         :      1 : "Desktop"'
    - 'AgentClass                          :     10 : "Special"'
    - 'AgentName                           :     10 : @OfficeAppName'
    - 'AgentVersion                        :     10 : @OfficeAppName^.version'

- matcher:
    require:
    - 'agent.(1)product.(1)name="Microsoft Office"'
    variable:
    - 'OfficeAppName: LookUp[MSOfficeApplicationNames;agent.(1)product.(1)comments.entry.product.name]'
    extract:
    - 'DeviceClass                         :      1 : "Desktop"'
    - 'AgentClass                          :     10 : "Special"'
    - 'AgentName                           :     11 : @OfficeAppName'
    - 'AgentVersion                        :     10 : @OfficeAppName^.version'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.name="Microsoft Outlook"'
    extract:
    - 'AgentClass                          :    100 :"Email Client"'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.name="MAPI"'
    extract:
    - 'AgentClass                          :    100 :"Email Client"'

# Lotus notes
- matcher:
    extract:
    - 'AgentClass                          :    100 :"Email Client"'
    - 'AgentName                           :    100 :"Lotus-Notes"'
    - 'AgentVersion                        :    100 :agent.(1)product.(1)comments.entry.(1)product.name="Lotus-Notes"^.version'

# Thunderbird
- matcher:
    extract:
    - 'AgentClass                          :   2100 :"Email Client"'
    - 'AgentName                           :   2100 :"Thunderbird"'
    - 'AgentVersion                        :   2100 :agent.product.name="Thunderbird"^.version'

